{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "github>damoun/renovate-config"
  ],
  "bumpVersion": "minor",
  "packageRules": [
    {
      "matchManagers": [
        "helm-requirements",
        "helm-values"
      ],
      "postUpgradeTasks": {
        "commands": [
          "version=$(grep '^version:' {{{parentDir}}}/Chart.yaml | awk '{print $2}')",
          "major=$(echo $version | cut -d. -f1)",
          "minor=$(echo $version | cut -d. -f2)",
          "patch=$(echo $version | cut -d. -f3)",
          "minor=$(expr $minor + 1)",
          "echo \"Replacing $version with $major.$minor.$patch\"",
          "sed -i \"s/^version:.*/version: $\\{major\\}.$\\{minor\\}.$\\{patch\\}/g\" {{{parentDir}}}/Chart.yaml",
          "cat {{{parentDir}}}/Chart.yaml"
        ],
        "fileFilters": [
          "**/Chart.yaml"
        ],
        "executionMode": "branch"
      }
    }
  ]
}
